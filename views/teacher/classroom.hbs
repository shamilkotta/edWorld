<nav
  class="container-fluid py-4 px-3 d-flex justify-content-between align-items-center border-bottom sticky"
  style="max-width: 1500px;"
>
  <a href="/">
    <img src="/static/svg/logo.svg" alt="edWorld" height="35px" />
  </a>
  <div>
    <a href="/logout" class="ms-3">
      <img
        src="/static/icon/logout.svg"
        alt="logout"
        height="28px"
        style="transform: rotate(180deg);"
      />
    </a>
  </div>
</nav>

<main class="container-fluid px-3" style="max-width: 1500px;">
  <div class="d-flex flex-wrap justify-content-end">
    <div class="tab-bar mb-4 ms-2 mt-2">
      <a
        href="/teacher"
        class="btn d-flex py-3 px-4 justify-content-center align-items-center rounded-3"
        style="background-color: #f1f1f1;"
      >
        <div
          class="d-flex flex-column justify-content-center align-items-center flex-sm-row"
          style="cursor: pointer;"
        >
          <img src="/static/icon/home.svg" width="25px" alt="" />
          <span class="ms-2">Profile</span>
        </div>
      </a>
    </div>
  </div>

  <section class="mt-1">
    <section>
      <div class="">
        <div class="row gy-4">
          <div class="col-md-3 col-sm-6">
            <div class="card shadow mb-0">
              <div class="card-body">
                <div
                  class="d-flex align-items-end justify-content-between mb-2"
                >
                  <div class="me-2">

                    <p
                      class="text-sm text-uppercase text-gray-600 lh-1 mb-0"
                    >New Clients</p>
                  </div>
                  <p class="fs-2 lh-1 mb-0 text-success">27</p>
                </div>
                <div class="progress" style="height: 3px">
                  <div
                    class="progress-bar bg-success"
                    role="progressbar"
                    style="width: 30%"
                    aria-valuenow="30"
                    aria-valuemin="0"
                    aria-valuemax="100"
                  ></div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3 col-sm-6">
            <div class="card shadow mb-0">
              <div class="card-body">
                <div
                  class="d-flex align-items-end justify-content-between mb-2"
                >
                  <div class="me-2">

                    <p
                      class="text-sm text-uppercase text-gray-600 lh-1 mb-0"
                    >New Projects</p>
                  </div>
                  <p class="fs-2 lh-1 mb-0 text-success">375</p>
                </div>
                <div class="progress" style="height: 3px">
                  <div
                    class="progress-bar bg-success"
                    role="progressbar"
                    style="width: 70%"
                    aria-valuenow="70"
                    aria-valuemin="0"
                    aria-valuemax="100"
                  ></div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3 col-sm-6">
            <div class="card shadow mb-0">
              <div class="card-body">
                <div
                  class="d-flex align-items-end justify-content-between mb-2"
                >
                  <div class="me-2">

                    <p
                      class="text-sm text-uppercase text-gray-600 lh-1 mb-0"
                    >New Invoices</p>
                  </div>
                  <p class="fs-2 lh-1 mb-0 text-success">140</p>
                </div>
                <div class="progress" style="height: 3px">
                  <div
                    class="progress-bar bg-success"
                    role="progressbar"
                    style="width: 55%"
                    aria-valuenow="55"
                    aria-valuemin="0"
                    aria-valuemax="100"
                  ></div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3 col-sm-6">
            <div class="card shadow mb-0">
              <div class="card-body">
                <div
                  class="d-flex align-items-end justify-content-between mb-2"
                >
                  <div class="me-2">

                    <p
                      class="text-sm text-uppercase text-gray-600 lh-1 mb-0"
                    >All Projects</p>
                  </div>
                  <p class="fs-2 lh-1 mb-0 text-success">140</p>
                </div>
                <div class="progress" style="height: 3px">
                  <div
                    class="progress-bar bg-success"
                    role="progressbar"
                    style="width: 55%"
                    aria-valuenow="55"
                    aria-valuemin="0"
                    aria-valuemax="100"
                  ></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <div
      class="d-flex flex-wrap align-items-center justify-content-evenly mt-4 shadow py-2"
      style="font-size: 18px; row-gap: 10px;"
    >
      <div class="mx-2">
        <span class="text-muted">Batch:</span>
        <span class="fw-bold" id="batch-code">{{batch.code}}</span>
      </div>
      <div style="color: #bbbbbb;">|</div>
      <div class="mx-2">
        <span class="text-muted">Start Date:</span>
        <span class="fw-bold">{{batch.start_date}}</span>
      </div>
      <div style="color: #bbbbbb;">|</div>
      <div class="mx-2">
        <span class="text-muted">Duration:</span>
        <span class="fw-bold">{{batch.duration}} months</span>
      </div>
      <div style="color: #bbbbbb;">|</div>
      <div class="mx-2">
        <span class="text-muted">End Date:</span>
        <span class="fw-bold">{{batch.end_date}}</span>
      </div>
      <div style="color: #bbbbbb;">|</div>
      <div class="mx-2">
        <span class="text-muted">Students:</span>
        <span class="fw-bold">{{batch.students}}</span>
      </div>
      <div style="color: #bbbbbb;">|</div>
      <div class="mx-2">
        <span class="text-muted">Seats:</span>
        <span class="fw-bold" id="seat-num">{{batch.seat_num}}</span>
      </div>
    </div>

    <h6 class="mb-2 mt-5">Monthly Working Days</h6>
    <div class="px-1 py-3 rounded working-days">
      
      <div class="btn working-days-card-add {{#if batch.month_end}}{{else}}disabled{{/if}}" {{#if batch.month_end}}data-mdb-toggle="modal" data-mdb-target="#addWorkingDays"{{/if}} >
        <img src="/static/icon/note-add.svg" alt="add">
        <div>Add new</div>
      </div>
      <div class="d-flex flex-row-reverse">
      {{#each batch.working_days}}
        <div class="btn working-days-card pt-2 px-2">
          <div class="working-days-card-count h-100 align-self-end" style="font-size: 55px; margin: -20px -3px 0 0;">{{this}}</div>
          <div class="working-days-card-text h-100 fs-3 align-self-start" style="margin: -10px 0 0 0;">{{{ superfix @index true }}} Month</div>
        </div>
      {{/each}}
      </div>
      
    </div>


    <h6 class="mb-4 mt-5">All Students</h6>
    <div class="table-responsive">
      <table class="table table-striped align-middle" id="batches-table">
        <thead class="bg-dark text-white">
          <tr>
            <th scope="col">Id</th>
            <th scope="col">Name</th>
            <th scope="col">Contact</th>
            <th scope="col">Batch</th>
            <th scope="col">Parent</th>
            <th scope="col">Education</th>
            <th scope="col">University</th>
            <th scope="col">View</th>
          </tr>
        </thead>
        <tbody>
          {{#each allStudents}}
            <tr>
              <td scope="row">{{this.registerId}}</td>
              <td class="d-flex align-items-center">
                <img
                  src="{{this.profile}}"
                  style="border-radius: 50%; border: 1px solid #3BB77E; padding: 1px"
                  width="40px"
                  height="40px"
                  class="me-2"
                  alt="{{this.name}}"
                />
                <div>
                  <span
                    class="fs-6 text-black fw-normal"
                  >{{this.name}}</span><br />
                  <span
                    class="text-muted"
                    style="font-size: 13px;"
                  >{{this.birth_date}}</span>
                </div>
              </td>
              <td>
                <a href="tel:{{this.phone}}" class="me-1">
                  <img src="/static/icon/phone.svg" width="34px" alt="call" />
                </a>
                <a href="mailto:{{this.email}}">
                  <img src="/static/icon/mail.svg" width="34px" alt="mail" />
                </a>
              </td>
              <td>{{this.batch}}</td>
              <td>{{this.parent_name}}</td>
              <td>{{this.education}}</td>
              <td>{{this.university}}</td>
              <td>
                <a href="/teacher/classroom/{{this.registerId}}">
                  <img src="/static/icon/export.svg" width="20px" alt="" />
                </a>
              </td>
            </tr>
          {{/each}}
        </tbody>
      </table>
    </div>
  </section>
</main>

{{! edit data modal }}
{{#if batch.month_end}}
<div
  class="modal fade"
  id="addWorkingDays"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Working Days -
          {{{superfix batch.current_month}}} month</h5>
        <button
          type="button"
          class="btn-close"
          data-mdb-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body pb-0">
        <form action="" id="addWorkingDaysForm">

          <div class="form-outline input-group-lg">
            <input
              type="number"
              id="working_days"
              name="working_days"
              class="form-control"
              required
              min="0"
            />
            <label class="form-label" for="working_days">Working days this month</label>
          </div>
          <p id="addWorkingDaysForm-response"></p>
          <div class="mt-3 d-flex justify-content-end">
            <button
              type="submit"
              class="btn btn-outline-success"
            >Add</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
{{/if}}


<script>
  const form = document.getElementById("addWorkingDaysForm")
  const response = document.getElementById("addWorkingDaysForm-response")
  const formSubmit = (e) => {
    e.preventDefault()
    const formData = new FormData(form);
    const dataToSend = Object.fromEntries(formData);

    fetch("/teacher/add-total-working-days", {
      method: "PUT",
      body: JSON.stringify(dataToSend),
      headers: {
        "Content-Type": "application/json",
      },
    }).then(() => {
      location.reload()
    })
  }

  form.addEventListener("submit", formSubmit)
</script>